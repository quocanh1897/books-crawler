services:
  binslib:
    build: .
    ports:
      - "8460:3000"
    volumes:
      - ../crawler/output:/data/crawler-output
      - ../meta-puller:/data/meta-puller:ro
      - ../epub-converter:/data/epub-converter
      - ./data:/app/data
      - ./public/covers:/app/public/covers
    environment:
      - DATABASE_URL=file:/app/data/binslib.db
      - CRAWLER_OUTPUT_DIR=/data/crawler-output
      - META_PULLER_DIR=/data/meta-puller
      - EPUB_CONVERTER_DIR=/data/epub-converter
      - EPUB_OUTPUT_DIR=/data/epub-converter/epub-output
      - NEXTAUTH_SECRET=${NEXTAUTH_SECRET:-change-me-in-production}
      - NEXTAUTH_URL=http://lib.binscode.site
    restart: unless-stopped
    container_name: binslib
